import React, { useState, useEffect, useRef } from 'react';
import { 
  Info, 
  MapPin, 
  Calendar, 
  Target, 
  ChevronLeft, 
  ChevronRight, 
  ZoomIn, 
  CheckCircle2,
  Megaphone,
  PlusCircle,
  ArrowRight,
  ArrowLeft,
  FileText,
  Table,
  X,
  MousePointer2,
  Maximize2
} from 'lucide-react';

// Plantilla base para nuevas iniciativas
const emptyInitiative = {
  title: "Nueva Iniciativa (En Edición)",
  description: "Descripción breve de la nueva estrategia...",
  sections: [
    {
      id: 'que',
      title: "¿Qué?",
      icon: <Info className="w-6 h-6" />,
      content: ["Definir el objetivo principal aquí."]
    },
    {
      id: 'como',
      title: "¿Cómo?",
      icon: <Megaphone className="w-6 h-6" />,
      content: ["Describir los pasos de implementación."]
    }
  ],
  galleryImages: [
    {
      src: "https://images.unsplash.com/photo-1497215728101-856f4ea42174?q=80&w=1000&auto=format&fit=crop",
      alt: "Espacio de trabajo",
      desc: "Imagen de referencia 1"
    }
  ]
};

// Datos iniciales
const initialInitiatives = [
  {
    id: 'senalizacion',
    title: "Iniciativa 1: Señalización del Módulo Autoservicio",
    description: "Estandarización visual para mejorar la identificación de servicios y la experiencia del cliente en sucursales.",
    sections: [
      {
        id: 'que',
        title: "¿Qué?",
        icon: <Info className="w-6 h-6" />,
        content: [
          "Crear material visual en cada sucursal con Asesor Previsional o Autoservicio para que los trabajadores identifiquen:",
          "1. Presencia de AFORE.",
          "2. Que existe módulo de Autoservicio."
        ]
      },
      {
        id: 'como',
        title: "¿Cómo?",
        icon: <Megaphone className="w-6 h-6" />,
        content: [
          "Solicitar diseño de material a Comunicación Integral.",
          "Lanzar una campaña promocional para dar a conocer al Cliente el nuevo indicador visual:",
          "- Videos en Redes Sociales",
          "- Estado de Cuenta",
          "- Aforecoppel.com",
          "- Campañas de mailing",
          "- Anuncios Espectaculares"
        ]
      },
      {
        id: 'donde',
        title: "¿En dónde?",
        icon: <MapPin className="w-6 h-6" />,
        content: [
          "1. Calcomanía de vinil en la entrada de la tienda (aprox 40x20 cm).",
          "2. Calcomanías / pegatinas en el piso.",
          "3. Copete de cloroplast armable y desmontable en la micro.",
          "4. Sticker pegado en el respaldo de la silla del cliente."
        ]
      },
      {
        id: 'responsables',
        title: "Implementación y Responsables",
        icon: <Calendar className="w-6 h-6" />,
        content: [
          "Q1 2026: Gestión del proyecto.",
          "Q3 2026: Liberación del proyecto.",
          "Responsable: Comunicación Integral.",
          "Corresponsable: Servicios y Proyectos Estratégicos."
        ]
      }
    ],
    galleryImages: [
      {
        src: "iniciativa1-entrada.jpg", // NOMBRE ACTUALIZADO
        fallbackSrc: "https://images.unsplash.com/photo-1541560052-5e13d97759de?q=80&w=1000&auto=format&fit=crop",
        alt: "Entrada de Sucursal con Vinil",
        desc: "Calcomanía de vinil en la entrada"
      },
      {
        src: "iniciativa1-copete.jpg", // NOMBRE ACTUALIZADO
        fallbackSrc: "https://images.unsplash.com/photo-1556761175-5973dc0f32e7?q=80&w=1000&auto=format&fit=crop",
        alt: "Copete de Cloroplast",
        desc: "Señalización tipo standee en pasillo"
      },
      {
        src: "iniciativa1-modulo.jpg", // NOMBRE ACTUALIZADO
        fallbackSrc: "https://images.unsplash.com/photo-1497366216548-37526070297c?q=80&w=1000&auto=format&fit=crop",
        alt: "Módulo de Autoservicio",
        desc: "Sticker en respaldo y señalética de piso"
      }
    ]
  },
  {
    id: 'kiosko',
    title: "Iniciativa 2: Kiosko Modelo Autoservicio",
    description: "Propuesta conceptual de diseño para la nueva estructura de módulos de autoservicio.",
    sections: [],
    galleryImages: [
      {
        src: "kiosko-autoservicio.jpg", // YA ESTABA CONFIGURADO
        fallbackSrc: "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?q=80&w=1000&auto=format&fit=crop",
        alt: "Render del Kiosko Modelo",
        desc: "Vista preliminar del Kiosko Modelo Autoservicio"
      }
    ]
  },
  {
    id: 'incentivos',
    title: "Iniciativa 3: Modificación al Modelo de Incentivo Fijo Escalonado",
    description: "Actualización del esquema de incentivos para transformar el indicador de servicios en un multiplicador que premie la excelencia.",
    layout: 'grid',
    sections: [
      {
        id: 'que',
        title: "¿Qué?",
        icon: <Info className="w-6 h-6" />,
        content: [
          "Modificar el modelo de incentivo fijo escalonado para que el indicador de servicios sea un multiplicador.",
          "Objetivo: Promover que los Asesores realicen servicios exitosos y puedan obtener un porcentaje adicional de incentivo."
        ]
      },
      {
        id: 'como',
        title: "¿Cómo?",
        icon: <Megaphone className="w-6 h-6" />,
        content: [
          "Redistribuyendo las ponderaciones entre los indicadores:",
          "- Volumetría de Servicios Efectivos",
          "- Cartera de Saldo atraído y NPS"
        ]
      },
      {
        id: 'tablas',
        title: "Propuesta de Pesos y Multiplicadores",
        icon: <Table className="w-6 h-6" />,
        fullWidth: true,
        content: [],
        tables: [
          {
            title: "Redistribución de Pesos",
            headers: ["Indicador", "Peso Actual", "Nuevo Peso"],
            rows: [
              ["Volumetría de trámites efectivos", "30", "35"],
              ["Cartera de Saldo atraído", "40", "45"],
              ["Efectividad en los servicios", "16", "NA"],
              ["NPS Afiliación", "4", "4"],
              ["NPS Retiros", "5", "5"],
              ["NPS Servicios", "5", "5"],
              ["Total", "100", "100"]
            ]
          },
          {
            title: "Nuevo Multiplicador de Efectividad",
            headers: ["Rango", "Mult.", "Interpretación"],
            rows: [
              ["≥ 95%", "1.20", "Premio: +20% extra"],
              ["≥ 80% < 95%", "1.00", "Neutro: Se cobra lo ganado"],
              ["< 80%", "0.80", "Castigo: Pierde 20%"]
            ]
          }
        ],
        footerNote: "El efecto esperado es que al hacer mal los servicios disminuirá el incentivo, pero hacerlo perfecto brindará un extra."
      }
    ],
    galleryImages: []
  }
];

export default function App() {
  const [initiatives, setInitiatives] = useState(initialInitiatives);
  const [currentIndex, setCurrentIndex] = useState(0);
  
  const [activeSlide, setActiveSlide] = useState(0);
  const [selectedSection, setSelectedSection] = useState(null);

  // Estados para el Lightbox (Pantalla completa)
  const [lightboxOpen, setLightboxOpen] = useState(false);
  const [isPointerActive, setIsPointerActive] = useState(false);
  const [pointerPos, setPointerPos] = useState({ x: 0, y: 0 });
  
  // Estado para la estela (trail) del puntero
  const [pointerTrail, setPointerTrail] = useState([]);

  // Referencia para el contenedor de la imagen en lightbox
  const imageContainerRef = useRef(null);

  // Obtener la iniciativa actual
  const currentInitiative = initiatives[currentIndex];
  
  // Verificar banderas de diseño
  const hasSections = currentInitiative.sections && currentInitiative.sections.length > 0;
  const isGridLayout = currentInitiative.layout === 'grid'; // Nuevo modo para Init 3

  const nextSlide = () => {
    if (currentInitiative.galleryImages.length > 0) {
      setActiveSlide((prev) => (prev + 1) % currentInitiative.galleryImages.length);
    }
  };

  const prevSlide = () => {
    if (currentInitiative.galleryImages.length > 0) {
      setActiveSlide((prev) => (prev - 1 + currentInitiative.galleryImages.length) % currentInitiative.galleryImages.length);
    }
  };

  const handleNextInitiative = () => {
    if (currentIndex < initiatives.length - 1) {
      setCurrentIndex(prev => prev + 1);
      setActiveSlide(0); 
      setSelectedSection(null);
      setLightboxOpen(false); 
      window.scrollTo(0, 0);
    }
  };

  const handlePrevInitiative = () => {
    if (currentIndex > 0) {
      setCurrentIndex(prev => prev - 1);
      setActiveSlide(0);
      setSelectedSection(null);
      setLightboxOpen(false);
      window.scrollTo(0, 0);
    }
  };

  const handleJumpToInitiative = (index) => {
    setCurrentIndex(index);
    setActiveSlide(0);
    setSelectedSection(null);
    setLightboxOpen(false);
    window.scrollTo(0, 0);
  };

  const handleNewInitiative = () => {
    const newInitiative = { ...emptyInitiative };
    setInitiatives([...initiatives, newInitiative]);
    setCurrentIndex(initiatives.length); 
    setActiveSlide(0);
    setSelectedSection(null);
  };

  // Manejo del puntero láser con efecto de estela
  const handleMouseMove = (e) => {
    if (isPointerActive && imageContainerRef.current) {
      const rect = imageContainerRef.current.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      setPointerPos({ x, y });

      // Añadir posición actual al historial de la estela
      setPointerTrail(prevTrail => {
        const newTrail = [...prevTrail, { x, y, id: Date.now() + Math.random() }];
        if (newTrail.length > 15) {
          return newTrail.slice(newTrail.length - 15);
        }
        return newTrail;
      });
    }
  };
  
  useEffect(() => {
    if (!isPointerActive) {
      setPointerTrail([]);
    }
  }, [isPointerActive]);

  const numericHeaders = ['Peso Actual', 'Nuevo Peso', 'Mult.'];

  return (
    <div className="min-h-screen bg-slate-50 font-sans text-slate-800 pb-20">
      
      {/* --- LIGHTBOX (PANTALLA COMPLETA) --- */}
      {lightboxOpen && (
        <div className="fixed inset-0 z-[100] bg-black/95 flex flex-col items-center justify-center animate-in fade-in duration-200">
          
          {/* Barra Superior Lightbox */}
          <div className="absolute top-0 left-0 right-0 p-4 flex justify-between items-center text-white bg-gradient-to-b from-black/50 to-transparent z-[110]">
            <h3 className="text-lg font-medium opacity-90">
              {currentInitiative.galleryImages[activeSlide]?.desc || "Vista Detallada"}
            </h3>
            <button 
              onClick={() => {
                setLightboxOpen(false);
                setIsPointerActive(false);
              }}
              className="p-2 hover:bg-white/20 rounded-full transition-colors"
            >
              <X className="w-8 h-8 text-white" />
            </button>
          </div>

          {/* Botones de Navegación del Lightbox */}
          {currentInitiative.galleryImages.length > 1 && (
            <>
              <button
                onClick={(e) => {
                  e.stopPropagation();
                  prevSlide();
                }}
                className="absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 hover:bg-white/30 hover:scale-110 rounded-full text-white backdrop-blur-sm transition-all z-[120] border border-white/20"
                aria-label="Imagen anterior"
              >
                <ChevronLeft className="w-8 h-8" />
              </button>

              <button
                onClick={(e) => {
                  e.stopPropagation();
                  nextSlide();
                }}
                className="absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 hover:bg-white/30 hover:scale-110 rounded-full text-white backdrop-blur-sm transition-all z-[120] border border-white/20"
                aria-label="Siguiente imagen"
              >
                <ChevronRight className="w-8 h-8" />
              </button>
            </>
          )}

          {/* Área de Imagen con Puntero */}
          <div 
            ref={imageContainerRef}
            className={`relative max-w-full max-h-[85vh] overflow-hidden ${isPointerActive ? 'cursor-none' : 'cursor-default'}`}
            onMouseMove={handleMouseMove}
            onClick={() => !isPointerActive && setIsPointerActive(true)}
          >
            <img 
              src={currentInitiative.galleryImages[activeSlide].src}
              alt="Fullscreen view"
              className="max-w-full max-h-[85vh] object-contain shadow-2xl relative z-0"
              onError={(e) => {
                 if (currentInitiative.galleryImages[activeSlide].fallbackSrc) {
                     e.target.src = currentInitiative.galleryImages[activeSlide].fallbackSrc;
                 }
              }}
            />
            
            {/* ESTELA (Trail) del Puntero */}
            {isPointerActive && pointerTrail.map((point, index) => (
              <div
                key={point.id}
                className="pointer-events-none absolute rounded-full bg-red-600 z-40"
                style={{
                  left: point.x,
                  top: point.y,
                  width: `${(index / pointerTrail.length) * 10 + 2}px`, 
                  height: `${(index / pointerTrail.length) * 10 + 2}px`,
                  opacity: (index / pointerTrail.length) * 0.6, 
                  transform: 'translate(-50%, -50%)',
                  boxShadow: `0 0 ${index}px rgba(220, 38, 38, 0.5)`
                }}
              />
            ))}

            {/* CABEZA del Puntero Láser */}
            {isPointerActive && (
              <div 
                className="pointer-events-none absolute w-3 h-3 rounded-full bg-red-600 shadow-[0_0_10px_2px_rgba(255,100,100,0.9)] border border-white/80 z-50 transform -translate-x-1/2 -translate-y-1/2"
                style={{ 
                  left: pointerPos.x, 
                  top: pointerPos.y,
                }}
              />
            )}
          </div>

          {/* Barra de Herramientas Inferior */}
          <div className="absolute bottom-8 flex gap-4 bg-white/10 backdrop-blur-md px-6 py-3 rounded-full border border-white/20 z-[110]">
             <button 
               onClick={() => setIsPointerActive(!isPointerActive)}
               className={`flex items-center gap-2 px-4 py-2 rounded-full font-semibold transition-all ${
                 isPointerActive 
                   ? 'bg-red-600 text-white shadow-[0_0_15px_rgba(220,38,38,0.6)]' 
                   : 'bg-white text-slate-800 hover:bg-slate-200'
               }`}
             >
               <MousePointer2 className="w-4 h-4" />
               {isPointerActive ? 'Desactivar Puntero' : 'Activar Puntero'}
             </button>
          </div>

          <div className="absolute bottom-2 text-white/50 text-xs z-[110]">
            Presiona ESC para salir
          </div>
        </div>
      )}

      {/* Header Corporativo */}
      <header className="bg-[#003876] text-white shadow-lg sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center relative">
          <div className="flex items-center gap-3 z-10">
            {/* Logo Afore Coppel */}
            <img 
              src="logo-aforecoppel.png"
              onError={(e) => {
                e.target.onerror = null;
                e.target.src = "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Coppel_logo.svg/2560px-Coppel_logo.svg.png"; 
              }}
              alt="Afore Coppel"
              className="h-10 w-auto object-contain rounded-lg px-2 py-1"
            />
          </div>

          {/* Título Centrado Absolutamente */}
          <div className="absolute inset-0 flex items-center justify-center pointer-events-none">
            <h1 className="text-sm sm:text-lg font-medium text-blue-100 hidden sm:block">
              Propuestas Equipo CAFÉ, GALLETAS Y ESTRATEGIA
            </h1>
          </div>

          <div className="z-10 flex items-center gap-3">
             {/* Logo del Equipo */}
             <img 
               src="logo-equipo.png" 
               onError={(e) => {
                 e.target.onerror = null; 
                 e.target.src = "https://cdn-icons-png.flaticon.com/512/1047/1047503.png"; 
               }}
               alt="Logo Equipo" 
               className="h-10 w-auto object-contain hover:scale-110 transition-transform bg-white/10 rounded-lg p-1"
             />
          </div>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-4 py-8">
        
        {/* Navegación Superior Breadcrumb */}
        <div className="flex items-center gap-2 text-sm text-slate-400 mb-6">
           <FileText className="w-4 h-4" />
           <span>Portafolio de Iniciativas</span>
           <span>/</span>
           <span className="text-[#003876] font-semibold">Iniciativa {currentIndex + 1}</span>
        </div>

        {/* Título Principal */}
        <div className="mb-10 text-center animate-in fade-in slide-in-from-bottom-4 duration-500">
          <div className="inline-block px-3 py-1 bg-blue-100 text-[#003876] rounded-full text-sm font-semibold mb-2">
            Iniciativa Estratégica {currentIndex + 1}
          </div>
          <h2 className="text-3xl md:text-4xl font-bold text-[#003876] mb-4">
            {currentInitiative.title}
          </h2>
          <p className="text-slate-600 max-w-2xl mx-auto">
            {currentInitiative.description}
          </p>
        </div>

        {/* CONTENEDOR PRINCIPAL */}
        <div className={
          isGridLayout 
            ? "max-w-6xl mx-auto" 
            : `grid grid-cols-1 ${hasSections ? 'lg:grid-cols-2' : ''} gap-8 items-start`
        }>
          
          {/* SECCIONES INTERACTIVAS */}
          {hasSections && (
            <div className={
              isGridLayout 
                ? "grid grid-cols-1 md:grid-cols-2 gap-6" 
                : "space-y-4"
            }>
              
              {currentInitiative.sections.map((section) => (
                <div 
                  key={section.id}
                  onClick={() => setSelectedSection(section.id === selectedSection ? null : section.id)}
                  className={`
                    bg-white rounded-xl p-6 cursor-pointer transition-all duration-300 border-2 overflow-hidden
                    ${selectedSection === section.id 
                      ? 'border-[#FFD100] shadow-xl scale-[1.01]' 
                      : 'border-transparent shadow-sm hover:shadow-md hover:border-blue-100'}
                    ${isGridLayout && section.fullWidth ? 'md:col-span-2' : ''}
                  `}
                >
                  <div className="flex items-start gap-4">
                    <div className={`
                      p-3 rounded-lg flex-shrink-0 transition-colors
                      ${selectedSection === section.id ? 'bg-[#003876] text-white' : 'bg-blue-50 text-[#003876]'}
                    `}>
                      {section.icon}
                    </div>
                    <div className="flex-1 w-full min-w-0">
                      <h3 className="font-bold text-lg text-[#003876] mb-2">{section.title}</h3>
                      
                      {/* Contenido de texto estándar */}
                      {section.content && section.content.length > 0 && (
                        <ul className="space-y-1 mb-4">
                          {section.content.map((line, idx) => (
                            <li key={idx} className="text-slate-600 text-sm leading-relaxed flex items-start gap-2">
                              <span className="mt-1.5 w-1.5 h-1.5 rounded-full bg-[#FFD100] flex-shrink-0"></span>
                              {line}
                            </li>
                          ))}
                        </ul>
                      )}

                      {/* Renderizado de Tablas */}
                      {section.tables && (
                        <div className="space-y-6 mt-4">
                          <div className={isGridLayout ? "flex flex-col lg:flex-row items-center gap-4" : "space-y-6"}>
                            {section.tables.map((table, tIdx) => (
                              <React.Fragment key={tIdx}>
                                <div 
                                  className={`
                                    overflow-x-auto bg-slate-50 rounded-lg p-2 border border-slate-100 flex-1 w-full
                                  `}
                                >
                                  <p className={`
                                    text-xs font-bold text-[#003876] mb-2 uppercase tracking-wide border-b border-blue-200 pb-2 mx-1
                                    ${isGridLayout ? 'text-center' : ''}
                                  `}>
                                    {table.title}
                                  </p>
                                  <table className="w-full text-xs text-left">
                                    <thead className="text-[#003876]">
                                      <tr>
                                        {table.headers.map((h, hIdx) => (
                                          <th 
                                            key={hIdx} 
                                            className={`
                                              px-2 py-2 font-bold border-b border-blue-200
                                              ${numericHeaders.includes(h) ? 'text-right' : 'text-left'}
                                            `}
                                          >
                                            {h}
                                          </th>
                                        ))}
                                      </tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-200">
                                      {table.rows.map((row, rIdx) => {
                                        const isHighlightRow = tIdx === 0 && row[0].includes("Efectividad");
                                        return (
                                          <tr key={rIdx} className={`
                                            ${rIdx % 2 === 0 ? 'bg-white' : 'bg-transparent'}
                                            ${isHighlightRow ? 'bg-red-50 border-l-4 border-red-500' : ''}
                                          `}>
                                            {row.map((cell, cIdx) => (
                                              <td 
                                                key={cIdx} 
                                                className={`
                                                  px-2 py-2 
                                                  ${cIdx === 0 ? 'font-medium text-slate-700' : 'text-slate-500'}
                                                  ${numericHeaders.includes(table.headers[cIdx]) ? 'text-right' : 'text-left'}
                                                `}
                                              >
                                                {cell}
                                              </td>
                                            ))}
                                          </tr>
                                        );
                                      })}
                                    </tbody>
                                  </table>
                                </div>
                                
                                {isGridLayout && tIdx === 0 && (
                                  <div className="hidden lg:flex flex-col items-center justify-center px-2 text-red-600 animate-pulse">
                                     <ArrowRight size={48} strokeWidth={3} />
                                  </div>
                                )}
                                {isGridLayout && tIdx === 0 && (
                                  <div className="lg:hidden flex justify-center text-red-600">
                                     <ArrowRight size={32} strokeWidth={3} className="rotate-90" />
                                  </div>
                                )}
                              </React.Fragment>
                            ))}
                          </div>

                          {section.footerNote && (
                            <div className="mt-4 p-3 bg-yellow-50 text-[#003876] text-xs rounded-lg border border-[#FFD100] flex items-center gap-2">
                              <Info className="w-4 h-4 flex-shrink-0" />
                              <span><strong>Nota:</strong> {section.footerNote}</span>
                            </div>
                          )}
                        </div>
                      )}
                    </div>
                    
                    {selectedSection === section.id && (
                      <CheckCircle2 className="w-5 h-5 text-[#003876] ml-auto flex-shrink-0" />
                    )}
                  </div>
                </div>
              ))}
            </div>
          )}

          {/* Columna Derecha: Carrusel Visual */}
          {!isGridLayout && (
             <div className={`${hasSections ? 'lg:sticky lg:top-24' : 'mx-auto max-w-4xl w-full'}`}>
              <div className="bg-white p-4 rounded-2xl shadow-xl border border-slate-100">
                <div className="flex justify-between items-center mb-4">
                  <h3 className="font-bold text-[#003876] flex items-center gap-2">
                    <Target className="w-5 h-5" />
                    Evidencia Visual
                  </h3>
                  <span className="text-xs font-mono text-slate-400">
                    {activeSlide + 1} / {currentInitiative.galleryImages.length}
                  </span>
                </div>

                {/* Área del Carrusel */}
                <div className="relative group overflow-hidden rounded-xl bg-slate-100 aspect-[16/9]">
                  
                  {/* IMAGEN PRINCIPAL */}
                  <div 
                    className="w-full h-full overflow-hidden cursor-pointer bg-slate-200 flex items-center justify-center group"
                    onClick={() => setLightboxOpen(true)}
                  >
                    {currentInitiative.galleryImages.length > 0 ? (
                      <img 
                        src={currentInitiative.galleryImages[activeSlide].src}
                        onError={(e) => {
                            if (currentInitiative.galleryImages[activeSlide].fallbackSrc) {
                                e.target.src = currentInitiative.galleryImages[activeSlide].fallbackSrc;
                            }
                        }}
                        alt={currentInitiative.galleryImages[activeSlide].alt}
                        className="w-full h-full object-cover transition-transform duration-500 ease-in-out group-hover:scale-105 origin-center"
                      />
                    ) : (
                      <div className="text-slate-400 text-sm">Sin imagen disponible</div>
                    )}
                    
                    {/* Overlay indicador de abrir pantalla completa */}
                    <div className="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center">
                       <div className="bg-black/60 backdrop-blur-sm text-white px-4 py-2 rounded-full text-sm flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity transform translate-y-4 group-hover:translate-y-0">
                         <Maximize2 className="w-4 h-4" />
                         Clic para ampliar y presentar
                       </div>
                    </div>
                  </div>

                  {currentInitiative.galleryImages.length > 1 && (
                    <>
                      <button 
                        onClick={(e) => { e.stopPropagation(); prevSlide(); }}
                        className="absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white text-[#003876] p-2 rounded-full shadow-lg backdrop-blur-sm transition-all opacity-0 group-hover:opacity-100"
                      >
                        <ChevronLeft className="w-6 h-6" />
                      </button>
                      <button 
                        onClick={(e) => { e.stopPropagation(); nextSlide(); }}
                        className="absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white text-[#003876] p-2 rounded-full shadow-lg backdrop-blur-sm transition-all opacity-0 group-hover:opacity-100"
                      >
                        <ChevronRight className="w-6 h-6" />
                      </button>
                    </>
                  )}
                </div>

                {/* Descripción de la imagen */}
                {currentInitiative.galleryImages.length > 0 && (
                  <div className="mt-4 p-4 bg-blue-50 rounded-lg border-l-4 border-[#FFD100]">
                    <p className="font-semibold text-[#003876] text-sm">
                      {currentInitiative.galleryImages[activeSlide].desc}
                    </p>
                    <p className="text-xs text-slate-500 mt-1">
                      Propuesta de implementación visual
                    </p>
                  </div>
                )}

                {/* Miniaturas */}
                {currentInitiative.galleryImages.length > 1 && (
                  <div className="flex gap-2 mt-4 overflow-x-auto pb-2 justify-center">
                    {currentInitiative.galleryImages.map((img, idx) => (
                      <button
                        key={idx}
                        onClick={() => setActiveSlide(idx)}
                        className={`
                          relative w-20 h-16 rounded-lg overflow-hidden flex-shrink-0 border-2 transition-all
                          ${activeSlide === idx ? 'border-[#003876] opacity-100' : 'border-transparent opacity-60 hover:opacity-100'}
                        `}
                      >
                        <img src={img.src} alt="thumbnail" className="w-full h-full object-cover" />
                      </button>
                    ))}
                  </div>
                )}
              </div>
              
               <div className="mt-6 text-center lg:text-left">
                  <p className="text-xs text-slate-400">
                    Documento confidencial para uso interno de Afore Coppel.
                  </p>
               </div>
            </div>
          )}
        </div>
      </main>

      {/* Barra de Navegación con Pestañas Animadas */}
      <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] py-4 z-40">
        <div className="max-w-7xl mx-auto px-4 flex justify-between items-center">
          
          <button 
            onClick={handlePrevInitiative}
            disabled={currentIndex === 0}
            className={`
              flex items-center gap-2 px-6 py-2 rounded-lg font-semibold transition-all
              ${currentIndex === 0 
                ? 'text-slate-300 cursor-not-allowed' 
                : 'text-[#003876] hover:bg-blue-50 hover:scale-105 active:scale-95'}
            `}
          >
            <ArrowLeft className="w-5 h-5" />
            <span className="hidden sm:inline">Anterior</span>
          </button>

          {/* Selector de Pestañas Animado (Carrusel) */}
          <div className="bg-slate-100 p-1 rounded-full relative flex items-center shadow-inner">
             {/* Fondo animado (Pill) */}
             <div 
               className="absolute top-1 bottom-1 w-10 bg-[#003876] rounded-full shadow-md transition-all duration-300 ease-out"
               style={{ 
                 left: '4px',
                 transform: `translateX(${currentIndex * 100}%)` 
               }}
             ></div>

             {/* Botones de Iniciativa */}
             {initiatives.map((_, idx) => (
               <button
                 key={idx}
                 onClick={() => handleJumpToInitiative(idx)}
                 className={`
                   relative z-10 w-10 h-8 flex items-center justify-center text-sm font-bold rounded-full transition-colors duration-200
                   ${currentIndex === idx ? 'text-white' : 'text-slate-500 hover:text-[#003876]'}
                 `}
               >
                 {idx + 1}
               </button>
             ))}
          </div>

          <button 
            onClick={handleNextInitiative}
            disabled={currentIndex === initiatives.length - 1}
            className={`
              flex items-center gap-2 px-6 py-2 rounded-lg font-semibold transition-all
              ${currentIndex === initiatives.length - 1
                ? 'text-slate-300 cursor-not-allowed'
                : 'bg-[#003876] text-white hover:bg-blue-800 shadow-lg hover:scale-105 active:scale-95'}
            `}
          >
            <span className="hidden sm:inline">Siguiente</span>
            <ArrowRight className="w-5 h-5" />
          </button>

        </div>
      </div>

    </div>
  );
}